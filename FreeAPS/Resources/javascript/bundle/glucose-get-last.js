var freeaps_glucoseGetLast;(()=>{"use strict";var e={696:(e,t)=>{function r(e){if(e.date)return e.date;if(e.display_time)return Date.parse(e.display_time);if(e.dateString)return Date.parse(e.dateString);throw new TypeError("Unable to find a date in GlucoseEntry")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){const t=e.reduce(((e,t)=>{const r=t.glucose||t.sgv;return r?[...e,Object.assign(Object.assign({},t),{glucose:r})]:e}),[]);let n,o=t[0],a=r(o),u=[],s=[],l=[],c=0;for(var d=1;d<t.length;d++){if(void 0!==t[d]&&"cal"===t[d].type){c=d;break}if(void 0!==t[d]&&t[d].glucose>38&&t[d].device===o.device){let e,c=t[d],i=r(c),g=0;if(void 0===i||void 0===a){console.error("Error: date field not found: cannot calculate avgdelta");continue}e=Math.round((a-i)/6e4),n=o.glucose-c.glucose,g=n/e*5,-2<e&&e<2.5?(o.glucose=(o.glucose+c.glucose)/2,a=(a+i)/2):2.5<e&&e<17.5?(s.push(g),2.5<e&&e<7.5&&u.push(g)):17.5<e&&e<42.5&&l.push(g)}}let i=0,g=0,f=0;return u.length>0&&(i=u.reduce((function(e,t){return e+t}))/u.length),s.length>0&&(g=s.reduce((function(e,t){return e+t}))/s.length),l.length>0&&(f=l.reduce((function(e,t){return e+t}))/l.length),{delta:Math.round(100*i)/100,glucose:Math.round(100*o.glucose)/100,noise:Math.round(o.noise||0),short_avgdelta:Math.round(100*g)/100,long_avgdelta:Math.round(100*f)/100,date:a,last_cal:c,device:o.device}};t.default=n,e.exports=n}},t={};var r=function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(696);freeaps_glucoseGetLast=r})();